This is the Kyoto loss-driven reorderer.
